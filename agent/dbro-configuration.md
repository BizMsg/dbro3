# DBRO Configuration

### Configuration 작성

```tsconfig
#####################################################################################################
#
# DBRO 3.4 Multi Config File - Release 2022.01.10 (UMGP 1.0)  
#
#####################################################################################################

#####################################################################################################
# DAOU G/W 연동 정보
#####################################################################################################
# 배정된 sms_ip / port 로의 방화벽 (Outbound) Open 여부를 반드시 체크!!
#####################################################################################################
sms_ip= 수신 발신 서버 IP (담당 영업사원 배정)
sms_port=4000
sms_id=아이디
sms_pwd=암호

#####################################################################################################
# AES 암호화 여부
#####################################################################################################
# 해당 옵션을 사용하기 위해선 G/W 연동 정보 sms_port 값을 암호화 포트 "4002" 로 변경
# 
# 설정값 (on) : 사용
# 설정값 (off) : 미사용
#####################################################################################################
dbro_sign=Off

#####################################################################################################
# 로그파일 저장 경로
#####################################################################################################
# 생략시 현재 실행 디렉토리에 DBRO_LOGS 폴더 생성 후 저장
# 윈도우 운영체제의 경우 "/" 또는 "\\" 로 경로 입력
#####################################################################################################
log_path=

#####################################################################################################
# MMS 컨텐츠 파일 (.SKN) 저장 경로
#####################################################################################################
# 생략시 현재 실행 디렉토리에 DBROSKN_FILES/YYYYMMDD(일자별) 폴더 생성 후 저장
# 윈도우 운영체제의 경우 "/" 또는 "\\" 로 경로 입력
#####################################################################################################
sknfile_path=

#####################################################################################################
# 결과 레포트 수신 대기시간
#####################################################################################################
# 발송 이후 설정한 시간까지 결과 리포트가 수신되지 않으면
# 해당레코드를 타임아웃( Timeout - tran_rslt '1' ) 실패 처리 후
# 로그(em_log_yyyymm) 테이블로 이동
#####################################################################################################
record_life_time=36

#####################################################################################################
# 데이터베이스 연동 설정
#####################################################################################################
# ORACLE, MSSQL, MYSQL, SYBASE, DB2, INFOMIX 연동 가능
# 연동할 DBMS의 JDBC 드라이버 정보 주석 해제 후, 데이터베이스 연동 정보 입력
#####################################################################################################
#
# ORACLE
# db_name=ORACLE
# db_driver=oracle.jdbc.driver.OracleDriver
# db_url=jdbc:oracle:thin:@ DB서버주소:1521:ORCL
#
# MSSQL (Microsoft SQL Server 2012)까지 지원 - JDBC Driver 4.0
# db_name=MSSQL
# db_driver=com.microsoft.sqlserver.jdbc.SQLServerDriver
# db_url=jdbc:sqlserver://DB서버주소:1433;DatabaseName=데이터베이스명
#
# MYSQL
# db_name=MYSQL
# db_driver=com.mysql.jdbc.Driver
# db_url=jdbc:mysql://DB서버주소:3306/데이터베이스명?useUnicode=true&characterEncoding=euc-kr
#
# SYBASE
# db_name=SYBASE
# db_driver=com.sybase.jdbc3.jdbc.SybDriver
# db_url=jdbc:sybase:Tds: DB서버주소:5000/데이터베이스명?CHARSET=eucksc
#
# DB2
# db_name=DB2
# db_driver=com.ibm.db2.jcc.DB2Driver
# db_url=jdbc:db2:// DB서버주소:50000/데이터베이스명
#
# INFORMIX
# db_name=INFORMIX
# db_driver=com.informix.jdbc.IfxDriver
# db_url=jdbc:informix-sqli://DB서버주소:555/데이터베이스:informixserver=INFORMIXSERVER_NAME
#
# TIBERO
# db_name=TIBERO
# db_driver=com.tmax.tibero.jdbc.TbDriver
# db_url=jdbc:tibero:thin:@DB서버주소:8629:데이터베이스
#
#####################################################################################################
# DB 캐릭터셋 (필수 입력 옵션)
db_charset=EUC-KR

#####################################################################################################
# 데이터베이스 유저 정보
db_userid=데이터베이스 접속아이디 (테이블 생성 권한 필요)
db_password=데이터베이스 접속암호

#####################################################################################################
# 발송 데이터 존재 여부 체크 주기 (초)
#####################################################################################################
tran_term=1

#####################################################################################################
# DBMS 연결 상태 체크 주기 (초)
#####################################################################################################
# 생략시 기본 60초
#####################################################################################################
db_ping_term=60

#####################################################################################################
# UFIT G/W 연결 상태 체크 주기 (초)
#####################################################################################################
ping_term=60

#####################################################################################################
# 순차 발송 처리 여부
#####################################################################################################
# EM_TRAN 테이블 발송 데이터 SELECT 시, TRAN_PR 정렬 (Order By) 여부를 설정함
#
# 설정 값 (On) : 순차 발송 처리
# 설정 값 (Off) : 무작위 발송 처리. 발송 성능 개선
#####################################################################################################
db_orderby=On

#####################################################################################################
# DBro Sender / Receiver 활성화
#####################################################################################################
# Sender : 발송 처리 쓰레드
# Receiver : 결과 수신 처리 쓰레드
#
# 설정 값 (On) : 활성화
# 설정 값 (Off) : 비활성화
#####################################################################################################
sender_switch=ON
receiver_switch=ON

#####################################################################################################
# 발송제한 시간 설정
#####################################################################################################
# 설정방법 예제
# ex) 23시 ~ 08시 발송 제한
# limit_begin=2300, limit_end=0800
#####################################################################################################
limit_begin=
limit_end=

#####################################################################################################
# Before Time (단위 시간)
#####################################################################################################
# EM_TRAN 발송 데이터 SELECT 시 기준 시간
# TRAN_DATE 입력 값이 "before_time 이전시간 ~ 현재시간" 에 만족할 경우 발송 처리
# 생략시 3시간
#####################################################################################################
before_time=

#####################################################################################################
# 로그테이블 (em_log_yyyymm) 이동 여부
#####################################################################################################
# db_nomove	: 결과 수신이후 LOG테이블로 이동하지 않음(1)
# db_npbatch	: 정기 BATCH 작업을 하지 않는다.(1)
# db_nomove, db_npbatch : 동일한 값을 지정을 설정
#####################################################################################################
db_nomove=
db_nobatch=

#####################################################################################################
# 로그 기록 범위
#####################################################################################################
# 설정 가능한 로그레벨 : "ERROR","WARN","INFO", "DEBUG"
# DBro 에러 발생 시, "DEBUG" 레벨로 변경 후 상세하게 기록된 로그를 확인
#####################################################################################################
consol.log_level=INFO
system.log_level=INFO
send.log_level=INFO
recv.log_level=INFO
info.log_level=INFOs
```

**sms\_ip, sms\_port**

(주)다우기술에서 SMS/URL/MMS 발송을 원하는 업체에 제공하며, DBro가 접속할 게이트 웨이의 ip와 port번호를 설정한다.

**smsg\_id, smsg\_pwd**

(주)다우기술에서 MMS/SMS 발송을 원하는 업체에 제공하며, 인증 시에 꼭 필요하다.

**log\_path**

log file이 기록될 폴더 설정, 생략 시 현재 DBro 실행 폴더에 DBRO\_LOGS 생성된 후에 로그가 기록된다.

**sknfile\_path**

셋팅시 MMS 메시지로 발송한 MMS파일이 꾸러미로 만들어진다.

{% hint style="info" %}
운영체제가 윈도우인 경우 path 경로를 "/" 또는 "\\\\" 로 입력하여야 합니다.
{% endhint %}

**dbro\_sign**

암호화 구간 설정, 모든 발송 전문을 암호화시켜 발송하고 수신한다.

**record\_life\_time**

여기에 설정된 시간이 지날 경우 더 이상 레포트를 기다리지 않고, 해당 레코드를 테이블로 이동시킨다. (단위: 시간)

**db\_name**

DBMS의 종류를 설정 한다.\
ORACLE, MSSQL, MYSQL, SYBASE, DB2, INFORMIX 中 1

**db\_driver, db\_url**

JDBC driver type 과 url을 설정한다.\
JDBC드라이버 설정, 구문이 복잡하므로 위에 있는 dbro.conf.sample 파일 내부의 예제를 복사해서 설정할 것을 권장.

**db\_userid / db\_password**

db\_user와 db\_password 는 각각 DB User name과 Password를 설정해 둔다.

**tran\_term**

전송을 위해서 트랜잭션 테이블을 조회하는 시간 간격으로 단위는 초이다. (default '1', 단위는 초)

**ping\_term**

DBro 가 GATEWAY에 PING을 보내는 시간 간격 설정(단위: 초)

**sender\_switch**

DBro의 발송모듈의 사용여부를 결정한다.\
(기본 설정은 ON이며 OFF로 하는 경우 발송 모듈을 실행하지 않게 됨)

**receiver\_switch**

DBro의 결과 수신모듈의 사용여부를 결정한다.\
(기본 설정은 ON이며 OFF로 하는 경우 결과수신 모듈을 실행하지 않게 됨)

**limit\_begin, limit\_end**

발송제한 시간대 설정\
limit\_begin=발송제한 시작 시간 (0100 \~ 2400) 분 단위까지 적용가능 limit\_end=발송제한 종료 시간 (0100 \~ 2400) 분 단위까지 적용 가능

**before\_time**

현재 시간으로부터 설정 시간 이전까지만 발송(tran\_date 기준)\
(기본 설정은 3시간이며 설정 이후 메시지에 대해서는 발송하지 않게 됨)

**db\_orderby**

DBMS에 SELECT 질의 시 tran\_pr 로 정렬해서 순서대로 가져올 것인가를 선택할 수 있는 기능

**logtable\_unify**

로그테이블을 단일테이블로 설정(on/off) 가능\
권장(기본설정)은 off 설정이며 em\_log\_YYYYMM 를 사용하는 것이 관리측면에서 효과적임 (설정 시 로그테이블명이 em\_log\_YYYYMM 인 테이블에서 em\_log 테이블로 고정 됨)

**db\_nomove, db\_nobatch**

결과 수신 이후 LOG 테이블로 자동으로 이동하는 옵션 정보

**consol.log\_level, system.log\_level, send.log\_level, recv.log\_level, info.log\_level**

각각 콘솔로그, 전체로그, 메시지 발송로그, 메시지 결과처리 로그, DBro 정보 로그이며, 모두 INFO로 설정 해서 사용한다. 프로그램상의 문제시에 DEBUG(개발자모드)로 프로그램의 상태를 확인해 볼 수 있다.



### 추가 옵션 구성

**추가 기능 사용 여부에 따라 설정할 수 있는 옵션에 대한 안내입니다.**

1\) 최초 발신사업자 식별코드(RESELLER\_CODE) 설정 (v5.8.0 이상)

RESELLER\_CODE 는 특부가사업자 등록번호(9 자리 숫자로 구성)를 의미합니다.&#x20;

1. USE\_RESELLERCODE (ON/OFF) 옵션 설정\
   메시지 발송시 식별코드를 포함하여 전송합니다.\
   \- config/dbro.conf 파일 내에 다음과 같이 설정하여 사용합니다.\
   "USE\_RESELLERCODE = Y" - 기본값(DEFAULT): N
2. 메시지/로그 테이블 RESELLER\_CODE VARCHAR(10) 컬럼 추가\
   \- 신규 설치시 위 옵션을 설정 후 구동하면 자동으로 추가됩니다.\
   \- 기존 테이블(EM\_TRAN/EM\_LOG)이 존재한다면 테이블 삭제 후 모듈을 재구동하거나 해당 컬럼을 추가하여 발송 가능합니다.

![](<../.gitbook/assets/image (2).png>)
