# 발송 결과 코드

### DBro 결과 코드

TRAN\_RSLT

| 결과코드 |                                  설명                                 |
| :--: | :-----------------------------------------------------------------: |
|   0  |                                  성공                                 |
|   1  | <p>타임아웃</p><p>(발송에 대한 결과수신대기 시간이 record_life_time 설정 값을 초과한 경우)</p> |
|   A  |                              핸드폰 호 처리중                              |
|   B  |                                음영 지역                                |
|   C  |                              power off                              |
|   D  |                             메시지 저장개수 초과                             |
|   2  |                               잘못된 전화번호                              |
|   a  |                              일시 서비스 정지                              |
|   b  |                              기타 단말기 문제                              |
|   c  |                                착신 거절                                |
|   d  |                                  기타                                 |
|   e  |              <p>이통사 SMC 형식 오류</p><p>(이통사 원인 확인 필요)</p>              |
|   f  |                            다우기술 자체 형식 오류                            |
|   g  |                            MMS 서비스 불가 단말기                           |
|   h  |                    핸드폰 호 불가 상태 - 다우기술에서 삭제 처리한 건                    |
|   i  |                           SMC 운영자가 메시지 삭제                           |
|   j  |                         이통사 내부 메시지 Que Full                         |
|   k  |                            이통사에서 spam 처리                            |
|   m  |                          다우기술에서 Spam 처리한 건                          |
|   o  |                       메시지의 길이가 제한된 길이를 벗어난 경우                       |
|   p  |                           폰 번호가 형식에 어긋난 경우                          |
|   q  |             <p>필드 형식이 잘못된 경우<br>(예 : 데이터 내용이 없는 경우)</p>             |
|   x  |                        MMS 콘텐츠의 정보를 참조할 수 없음                        |
|   v  |                            발신번호 미등록 차단 상태                           |
|   w  |                            발신번호 세칙 위반 오류                            |
|   z  |                            처리되지 않은 기타 오류                            |

{% hint style="info" %}
성공코드 '0' 을 수신하였으나 고객 단말로 메시지가 수신되지 않은 경우는\
통신사 **\[스팸 차단 부가서비스]** 에 의한 차단일 가능성이 높습니다.

스팸 차단 부가서비스의 경우 연령 제한 없이 전 고객 대상 신규/명의변경/기기변경 시 자동가입이 되며 자동가입이기 때문에 대부분의 고객님께서 가입상태를 모르시는 경우가 많습니다.

스팸 차단 된 문자 내역을 보시길 원하신다면 통신사 별로 아래 방법을 참조하시기 바랍니다.
{% endhint %}

> #### SKT
>
> 'T스팸필터링' 어플 다운 또는 T world(http://www.tworld.co.kr) 접속> 통합검색창에 '스팸필터링' 검색> 설정>휴대폰 본인인증>스팸내역조회
>
> #### KT
>
> 올레 홈페이지(http://www.olleh.com) 접속> 통합검색창에 '스팸차단서비스' 검색 >좌측상단에 스팸메세지함
>
> #### LGU+
>
> 엘지 유플러스 홈페이지 (http://mobile.uplus.co.kr) 접속>개인>모바일>편의서비스>통화보호>스팸차단>스팸내역 조회

이통사까지 전달된 경우는 최종착신 망 정보가 tran\_net 필드에 아래처럼 채워집니다.

![](<.gitbook/assets/image (3).png>)

최종착신 망: SKT / KT / LGT

### 결과 수신

tran\_rslt는 tran\_status 값이 3인 경우에만 최종 완료된 상태이며\
"0" – 성공, "1" – 전송실패, "2" – 잘못된 전화번호 등의 값을 갖습니다. (결과코드 표 참조 )

전송된 메시지에 대하여 결과가 수신되었을 때에는 (상태변화 2->3) 결과가 도착할 때, DBRO.receiver 에 다음과 같은 패킷을 전송합니다.

tran\_pr 및 code 는 모두 readable character로 되어 있으며, space는 ascii code: 0x20 입니다.\
UDP 결과 알림은 보낸 메시지에 대한 결과가 도착했을 때에만 알려오며, 처음 전송 시 없는 망식별번호에 의한 에러(상태변화 1->3)는 알리지 않습니다.

### 로그 테이블

일반적으로 em\_tran 에 있는 레코드 수는 5만개 이내를 권장합니다. 더더욱 빈번하다면, 1 만개 이하로 유지하는 것을 권장합니다.

때문에, 일정시간이 지난 레코드들에 대해서 가장 빈번한 입출력이 일어나는 em\_tran 에서 다른 테이블로 옮기도록 정책을 세우는 것이 좋은데 환경 설정파일에서 다룬 두 값으로 정책을 결정합니다.\
레코드는 결과 수신 여부와 상관없이 tran\_date 에 해당하는 날짜에서 일정한 시간 (DBRO.recordlife; 단위: 시간)이 지나면, em\_tran 테이블에서 em\_log\_YYYYMM 테이블로 옮겨집니다.\
Log 테이블은 tran\_date 의 년/월 에 해당하는 테이블로 옮겨지게 되며, 테이블이 없어서 실패가 된 경우에는 테이블을 작성하고 다시 옮깁니다. DBRO.recordlife 값이 0이면 옮기지 않습니다.\
로그 테이블 또한 em\_tran과 똑같은 scheme으로 되어 있으므로, 로그 테이블 참조 시 em\_tran 처럼 다루면 됩니다.

만약, 어떤 이유로 em\_tran 에서 모든 일을 처리하도록, 로그테이블로 옮기지 않도록 하는 방법은 db\_nomove= 1, db\_nobatch= 1으로 설정하면 됩니다.
